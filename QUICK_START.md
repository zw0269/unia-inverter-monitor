# 快速启动指南

## 一、环境准备

### 必需软件

1. **Node.js** (v16+)
   - 下载: https://nodejs.org/
   - 验证: `node -v`

2. **npm** (通常随Node.js安装)
   - 验证: `npm -v`

### 可选软件（根据目标平台）

- **微信开发者工具** - 用于微信小程序开发
- **HBuilderX** - 用于App开发
- **Chrome浏览器** - 用于H5开发

## 二、安装依赖（⭐必做）

打开命令行/终端，执行：

```bash
# 进入项目目录
cd F:\unia

# 安装依赖
npm install
```

等待安装完成（可能需要几分钟）。

## 三、启动开发服务器

### 方式1: H5开发（推荐新手）

```bash
npm run dev:h5
```

然后浏览器访问: http://localhost:3000

### 方式2: 微信小程序

```bash
npm run dev:mp-weixin
```

然后用微信开发者工具打开 `dist/dev/mp-weixin` 目录

### 方式3: App开发

```bash
npm run dev:app
```

然后使用HBuilderX运行到手机或模拟器

## 四、首次使用步骤

### 1. 打开应用

应用启动后会看到首页（监控页面）

### 2. 连接设备

- 点击"连接设备"或"扫描设备"按钮
- 进入蓝牙扫描页面
- 点击"开始扫描"
- 等待发现设备（会显示3个模拟设备）
- 点击任意设备进行连接

### 3. 查看实时数据

- 连接成功后自动返回首页
- 实时数据会每2秒自动更新
- 可以看到：
  - 设备状态
  - 当前功率
  - 今日发电量
  - 直流/交流侧数据
  - 功率曲线图

### 4. 浏览其他页面

通过底部TabBar切换：
- **监控** - 实时数据监控
- **统计** - 数据统计和图表
- **设备** - 设备管理和操作
- **我的** - 系统设置和信息

## 五、常见问题解决

### Q1: npm install 失败？

**解决方案A**: 使用淘宝镜像
```bash
npm install --registry=https://registry.npmmirror.com
```

**解决方案B**: 使用cnpm
```bash
npm install -g cnpm --registry=https://registry.npmmirror.com
cnpm install
```

### Q2: TabBar图标不显示？

**临时解决**: 编辑 `src/pages.json`，注释掉所有iconPath：

```json
{
  "pagePath": "pages/index/index",
  "text": "监控",
  // "iconPath": "static/tabbar/monitor.png",
  // "selectedIconPath": "static/tabbar/monitor-active.png"
}
```

### Q3: 图表不显示？

检查lime-echart是否安装成功：
```bash
npm list lime-echart
```

如果未安装，手动安装：
```bash
npm install lime-echart echarts
```

### Q4: 端口被占用？

修改 `vite.config.ts` 中的端口：
```typescript
server: {
  port: 3001, // 改成其他端口
  host: '0.0.0.0'
}
```

### Q5: 数据不更新？

1. 检查是否已连接设备
2. 打开浏览器控制台查看是否有错误
3. 刷新页面重新连接

## 六、开发提示

### 1. 查看Mock数据逻辑

编辑文件: `src/mock/device/realtime.ts`

可以调整：
- 光伏功率曲线
- 发电时段
- 数据波动范围

### 2. 修改数据推送频率

编辑文件: `src/api/bluetooth/mock.ts`

找到这行代码：
```typescript
this.dataTimer = setInterval(() => {
  this.pushData()
}, 2000) // 改这个数字（毫秒）
```

### 3. 调整UI样式

- 全局样式: `src/App.vue`
- 样式变量: `src/uni.scss`
- 页面样式: 各个 `.vue` 文件的 `<style>` 部分

### 4. 查看调试信息

在个人中心页面开启"调试信息"开关，可以在控制台看到详细日志。

## 七、功能演示流程

### 完整演示流程（3分钟）

1. **启动应用** (10秒)
   - 看到首页，设备显示"未连接"

2. **连接设备** (30秒)
   - 点击"连接设备"
   - 点击"开始扫描"
   - 等待设备列表显示
   - 点击第一个设备连接
   - 等待连接成功提示

3. **查看实时数据** (60秒)
   - 自动返回首页
   - 观察数据每2秒更新
   - 查看功率曲线图
   - 滚动查看直流/交流侧数据
   - 查看今日发电量

4. **浏览统计页** (30秒)
   - 切换到"统计"标签
   - 查看发电量趋势图
   - 查看功率曲线
   - 切换时间范围

5. **设备管理** (30秒)
   - 切换到"设备"标签
   - 查看设备信息
   - 查看连接状态
   - 测试断开连接

6. **个人中心** (20秒)
   - 切换到"我的"标签
   - 查看系统信息
   - 查看数据统计

## 八、目录说明

```
F:\unia\
├── src/
│   ├── pages/          # 页面文件（修改UI主要在这里）
│   ├── store/          # 状态管理（数据逻辑在这里）
│   ├── mock/           # Mock数据（调整模拟数据）
│   ├── api/            # API接口（蓝牙通信逻辑）
│   ├── types/          # 类型定义
│   └── utils/          # 工具函数
├── static/             # 静态资源（图片等）
├── package.json        # 依赖配置
└── README.md           # 详细文档
```

## 九、Phase 2 新功能（收益计算模块）

### 收益统计页面
- **路径**: `/pages/revenue/index`
- **入口**: 首页收益卡片 → 点击"查看详情"
- **功能**:
  - 时间范围选择（今日/本周/本月/本年）
  - 收益概览（总收益、自用收益、上网收益、补贴收益）
  - 收益趋势图表
  - 发电量对比图表
  - 收益明细列表

### 电价配置页面
- **路径**: `/pages/revenue/config`
- **入口**: 收益统计页面 → 点击右下角配置按钮
- **功能**:
  - 峰谷平电价设置
  - 上网电价配置
  - 光伏补贴设置
  - 收益预览
  - 保存/恢复默认

### 统计页面图表恢复
- **路径**: `/pages/statistics/index`
- **新增图表**:
  - 发电量趋势（柱状图）
  - 功率曲线（折线图）
  - 效率分析（折线图）

### ⚠️ 重要提示
- 图表功能仅在 H5 平台可用
- 当前使用 Mock 数据
- 需要浏览器访问 http://localhost:3001

## 十、下一步

1. ✅ 确保项目能正常运行
2. ✅ 熟悉各个页面功能
3. ✅ 了解Mock数据生成逻辑
4. ✅ 测试收益计算功能
5. ✅ 测试图表显示
6. 📝 根据实际需求修改UI
7. 📝 参考UI效果图优化界面
8. 📝 添加TabBar图标
9. 📝 准备切换到真实蓝牙

## 十、获取帮助

- 查看 `README.md` - 详细项目说明
- 查看 `PROJECT_FILES.md` - 文件清单和功能说明
- 查看代码注释 - 每个文件都有详细注释

## 十一、联系支持

如遇到问题，请：
1. 先查看"常见问题解决"
2. 检查浏览器控制台错误信息
3. 确认依赖是否正确安装

---

**祝开发顺利！** 🚀
